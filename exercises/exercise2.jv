constraint Value oftype DenylistConstraint {
  denylist: [""];
}
valuetype Value oftype text {
  constraints: [ Value ];
}
constraint IFOPT oftype RegexConstraint {
  regex: /[a-z]{2}:\d+\d+(:\d+)?(:\d+)?/;
}
valuetype IFOPT oftype text {
  constraints: [ IFOPT, Value ];
}
constraint Verkehr oftype AllowlistConstraint {
  allowlist: ["FV", "RV", "nur DPN"];
}
valuetype Verkehr oftype text {
  constraints: [ Verkehr, Value];
}
constraint Laenge oftype RangeConstraint {
  lowerBound: -90;
  lowerBoundInclusive: true;
  upperBound: 90;
  upperBoundInclusive: true;
}
valuetype Laenge oftype integer {
  constraints: [ Laenge ];
}
pipeline trainstopsPipeline {
block DataExtractor oftype HttpExtractor { url: "https://download-data.deutschebahn.com/static/datasets/haltestellen/D_Bahnhof_2020_alle.CSV"; }
block trainstopsTextFileInterpreter oftype TextFileInterpreter {}
block trainstopsCSVInterpreter oftype CSVInterpreter { delimiter: ";" ;}
block StatusDeleter oftype ColumnDeleter {
    delete: [column J ];
  }
block trainstopsTableInterpreter oftype TableInterpreter {
header: true;
columns: [
"EVA_NR" oftype Value,
"DS100" oftype Value,
"IFOPT" oftype IFOPT,
"NAME" oftype Value,
"Verkehr" oftype Verkehr,
"Laenge" oftype Laenge,
"Breite" oftype Laenge,
"Betreiber_Name" oftype Value,
"Betreiber_Nr" oftype integer,
];
}
block DatabaseLoader oftype SQLiteLoader { table: "trainstops"; file: "./trainstops.sqlite"; }
DataExtractor
->trainstopsTextFileInterpreter
->trainstopsCSVInterpreter
->StatusDeleter
->trainstopsTableInterpreter
->DatabaseLoader;
}